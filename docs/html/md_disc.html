<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>megadev: CD Mastering</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">megadev
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">A Sega Mega CD development framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CD Mastering </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The format of the binary data on a Compact Disc is defined by a series of standards developed over the years. For the Mega CD system, CD Audio (the Red Book standard) and CD-ROM (the Yellow Book standard) formats are used. CD Audio is the original and most prevalent format, containing 16-bit stereo PCM audio dividided into tracks. CD-ROM was developed later and is used to store data in a standardized file system called ISO9660.</p>
<p>These formats can be mixed (what is called a "mixed mode" disc) and indeed this is how you can achieve CD audio playback in your game. However, if you are unfamiliar with creating such discs, please read through the notes below.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
The ISO file</h1>
<p>There are often misconceptions about CD images. You may be familiar with ISO files and consider them an "image" of the disc. This is not entirely true. An ISO file is a dump of a data track in the CD-ROM ISO9660 format. It is an image of a file system only. It is likely, in the case of a standard CD-ROM, that the ISO is the entirety of the readable data on the disc, but it is not a true image inasmuch as it has not copied e.g. the lead in/out or the subcode channels.</p>
<p>When building your game in Megadev, an ISO file will be generated. You can run this in an emulator as-is, or burn it to a CD and the burning software will generate the necessary metadata as it is a simple layout.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Including Files on the Disc</h1>
<p>By default, there will be a <code>disc</code> directory created in your project. Any files you add to this directory will be added to the final ISO image. All modules and other final binaries generated from the code will automatically be added to this directory before the ISO is created.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
CD Audio</h1>
<p>CD-DA is 16 bit stereo PCM data sampled at 44.1khz. Ideally, your source audio should be a raw WAV in this format. Your burning software may allow you to use other formats, but these will be converted to the CD-DA format. Note that lossy formats such as MP3 should be avoided if possible.</p>
<p>You cannot simply add a .WAV or .MP3 file to the <code>disc</code> directory and expect to have CD audio (CD-DA). This is because CD-DA is a different standard than CD-ROM. The burning software will deal with the conversion of the audio file to the correct CD-DA data, but we must also specify the track layout.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
The CUE sheet</h1>
<p>At the start of all CDs is a "lead-in" area which includes the definition of the layout of the disc. This is called the Table of Contents (TOC), and it specifies the start and stop locations of each track. In order to include CD-DA, we need to specify such a layout for our audio tracks as well as the CD-ROM data track.</p>
<p>A CUE file is a text file that represents the TOC on the disc. It is a simple format where the source files on your computer are specifed by the track number they should appear on the disc. For mixed-mode CDs, the data track will always be track 1 while audio tracks come after it. As an example: </p><pre class="fragment">FILE "game.iso" BINARY
  TRACK 01 MODE1/2048
    INDEX 01 00:00:00
FILE "track02.wav" WAVE
  TRACK 02 AUDIO
    INDEX 00 00:00:00
    INDEX 01 00:02:00
FILE "track03.wav" WAVE
  TRACK 03 AUDIO
    INDEX 00 00:00:00
    INDEX 01 00:02:00
</pre><p> The basic concept is to specify a source file, a track type and a time index, which is relative to the end of the previous entry. For track 1, we specify mode 1, which is the standard CD-ROM format allowing for 2048 bytes per sector. For audio tracks, we indicate it is an audio track and specify two time indices: The first is the pre-gap, which is played as one track naturally transitions to the other, and the second is the start point when seeking through tracks with next/previous. Per the official documentation, due to the seek time of the drive, there should be a 2 second pre-gap on each audio track.</p>
<p>You will find <code>example.cue</code> within the <code>etc</code> directory of the megadev directory. You can copy this file and modify the audio track entries as necessary. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
